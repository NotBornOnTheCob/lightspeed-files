!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,(function(r){return o(e[i][1][r]||r)}),p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){(function(process){(function(){exports.formatArgs=function(args){if(args[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+args[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;args.splice(1,0,c,"color: inherit");let index=0,lastC=0;args[0].replace(/%[a-zA-Z%]/g,match=>{"%%"!==match&&(index++,"%c"===match&&(lastC=index))}),args.splice(lastC,0,c)},exports.save=function(namespaces){try{namespaces?exports.storage.setItem("debug",namespaces):exports.storage.removeItem("debug")}catch(error){}},exports.load=function(){let r;try{r=exports.storage.getItem("debug")}catch(error){}!r&&void 0!==process&&"env"in process&&(r=process.env.DEBUG);return r},exports.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},exports.storage=function(){try{return localStorage}catch(error){}}(),exports.destroy=(()=>{let warned=!1;return()=>{warned||(warned=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],exports.log=console.debug||console.log||(()=>{}),module.exports=require("./common")(exports);const{formatters}=module.exports;formatters.j=function(v){try{return JSON.stringify(v)}catch(error){return"[UnexpectedJSONParseError]: "+error.message}}}).call(this)}).call(this,require("_process"))},{"./common":2,_process:4}],2:[function(require,module,exports){module.exports=function(env){function createDebug(namespace){let prevTime,namespacesCache,enabledCache,enableOverride=null;function debug(...args){if(!debug.enabled)return;const self=debug,curr=Number(new Date),ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,args[0]=createDebug.coerce(args[0]),"string"!=typeof args[0]&&args.unshift("%O");let index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,(match,format)=>{if("%%"===match)return"%";index++;const formatter=createDebug.formatters[format];if("function"==typeof formatter){const val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),createDebug.formatArgs.call(self,args);(self.log||createDebug.log).apply(self,args)}return debug.namespace=namespace,debug.useColors=createDebug.useColors(),debug.color=createDebug.selectColor(namespace),debug.extend=extend,debug.destroy=createDebug.destroy,Object.defineProperty(debug,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==enableOverride?enableOverride:(namespacesCache!==createDebug.namespaces&&(namespacesCache=createDebug.namespaces,enabledCache=createDebug.enabled(namespace)),enabledCache),set:v=>{enableOverride=v}}),"function"==typeof createDebug.init&&createDebug.init(debug),debug}function extend(namespace,delimiter){const newDebug=createDebug(this.namespace+(void 0===delimiter?":":delimiter)+namespace);return newDebug.log=this.log,newDebug}function toNamespace(regexp){return regexp.toString().substring(2,regexp.toString().length-2).replace(/\.\*\?$/,"*")}return createDebug.debug=createDebug,createDebug.default=createDebug,createDebug.coerce=function(val){if(val instanceof Error)return val.stack||val.message;return val},createDebug.disable=function(){const namespaces=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map(namespace=>"-"+namespace)].join(",");return createDebug.enable(""),namespaces},createDebug.enable=function(namespaces){let i;createDebug.save(namespaces),createDebug.namespaces=namespaces,createDebug.names=[],createDebug.skips=[];const split=("string"==typeof namespaces?namespaces:"").split(/[\s,]+/),len=split.length;for(i=0;i<len;i++)split[i]&&("-"===(namespaces=split[i].replace(/\*/g,".*?"))[0]?createDebug.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):createDebug.names.push(new RegExp("^"+namespaces+"$")))},createDebug.enabled=function(name){if("*"===name[name.length-1])return!0;let i,len;for(i=0,len=createDebug.skips.length;i<len;i++)if(createDebug.skips[i].test(name))return!1;for(i=0,len=createDebug.names.length;i<len;i++)if(createDebug.names[i].test(name))return!0;return!1},createDebug.humanize=require("ms"),createDebug.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(env).forEach(key=>{createDebug[key]=env[key]}),createDebug.names=[],createDebug.skips=[],createDebug.formatters={},createDebug.selectColor=function(namespace){let hash=0;for(let i=0;i<namespace.length;i++)hash=(hash<<5)-hash+namespace.charCodeAt(i),hash|=0;return createDebug.colors[Math.abs(hash)%createDebug.colors.length]},createDebug.enable(createDebug.load()),createDebug}},{ms:3}],3:[function(require,module,exports){var s=1e3,m=6e4,h=60*m,d=24*h;function plural(ms,msAbs,n,name){var isPlural=msAbs>=1.5*n;return Math.round(ms/n)+" "+name+(isPlural?"s":"")}module.exports=function(val,options){options=options||{};var type=typeof val;if("string"===type&&val.length>0)return function(str){if((str=String(str)).length>100)return;var match=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(str);if(!match)return;var n=parseFloat(match[1]);switch((match[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(val);if("number"===type&&isFinite(val))return options.long?function(ms){var msAbs=Math.abs(ms);if(msAbs>=d)return plural(ms,msAbs,d,"day");if(msAbs>=h)return plural(ms,msAbs,h,"hour");if(msAbs>=m)return plural(ms,msAbs,m,"minute");if(msAbs>=s)return plural(ms,msAbs,s,"second");return ms+" ms"}(val):function(ms){var msAbs=Math.abs(ms);if(msAbs>=d)return Math.round(ms/d)+"d";if(msAbs>=h)return Math.round(ms/h)+"h";if(msAbs>=m)return Math.round(ms/m)+"m";if(msAbs>=s)return Math.round(ms/s)+"s";return ms+"ms"}(val);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))}},{}],4:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],5:[function(require,module,exports){(function(process){(function(){const d=require("debug")("alert"),Remote=require("./remote"),delayInt=process.env.SEND_DELAY||15e3,wordMin=process.env.WORD_MIN||1,wordMax=process.env.WORD_MAX||500;async function getHistory(){d("[getHistory]");const urls=[],clip=(new Date).getTime()-9e5;return(await function(){if(chrome&&chrome.history)return new Promise((resolve,_)=>{chrome.history.search({text:"",maxResults:5},resolve)});return[]}()).forEach(history=>{if(history.lastVisitTime>clip){const data={at:history.lastVisitTime,url:cleanUrl(history.url)};history.title&&(data.title=history.title.slice(0,100),history.title.length>100&&(data.title+="...")),urls.push(JSON.stringify(data))}}),urls}async function getTabs(){d("[getTabs]");return(await new Promise((resolve,_)=>{chrome.tabs.query({},resolve)})).map(tab=>{const data={id:tab.id,url:cleanUrl(tab.url)};return tab.title&&(data.title=tab.title.slice(0,100),tab.title.length>100&&(data.title+="...")),JSON.stringify(data)})}const tabData={};function sendCurrentData(tabId){const td=tabData[tabId];td&&(delete tabData[tabId],async function(data){d("[sendData]"),data.history=await getHistory(),data.tabs=await getTabs(),data.url=data.url,Remote.Alert(data)}(td.data))}let lastScreenshot,screenshotInt;async function getScreenshot(){if(Object.keys(tabData).length>0){const data=await new Promise((resolve,_)=>{d("[captureVisibleTab]"),chrome.tabs.captureVisibleTab({format:"jpeg",quality:20},resolve)});chrome.runtime.lastError,data&&"string"==typeof data&&(lastScreenshot=data.split(";base64,")[1]),screenshotInt=setTimeout(getScreenshot,550)}else d("[getScreenshot] shutting down screenshots"),clearTimeout(screenshotInt),screenshotInt=void 0}async function updateCurrentData(data,text){tabData[data.tabId]||(tabData[data.tabId]={at:Date.now(),data:{}}),data.url=cleanUrl(data.url),data.screenshot=await async function(){return screenshotInt||(d("[screenshotData] start getting screenshots"),await getScreenshot()),lastScreenshot}(),data.text=function(text){let cText=function(text){let cleanerText=text.toLowerCase().trim();for(const str of cleanStringsExp)cleanerText=cleanerText.replace(str,"");return cleanerText=cleanerText.replace(/\s+/g," "),cleanerText}(text);return cText=cText.replace(/\d{4}(\s|-)?\d{4}(\s|-)?\d{4}(\s|-)?\d{4}(\s?\d{2}?\/?\d{2})*/gi,d=>"X".repeat(d.length)),cText=cText.replace(/\d{3}.?\d{2}.?\d{4}/gi,d=>"X".repeat(d.length)),cText=cText.replace(/\d{3}.?\d{3}.?\d{4}/gi,d=>"X".repeat(d.length)),cText=cText.replace(/\d{5,}/gi,d=>"X".repeat(d.length)),d("[cleanText] -> ",cText),cText.replace(/\s+/g," ")}(text),data.rawText=text,tabData[data.tabId].data=data,d("[updateCurrentData] updated text ->",text)}setInterval((function(){const now=Date.now();for(const tabId in tabData){const tab=tabData[tabId];tab&&tab.at<now-delayInt&&sendCurrentData(tabId)}}),1e3);const cleanStringsExp=["\\n","\\","===","==","\n",/[.,\/#!?$%\^&\*;:{}=\-_`~()]/g];function cleanUrl(url){return url.replace(/(\?[^#]+)(#|$)/,"$2")}module.exports.ProcessText=async function(data){d("[ProcessText] -> ",data);const words=data.text.split(" ");if(words.length>=wordMin){let firstWord=0,lastWord=wordMax-1,currText=words.slice(firstWord,lastWord).join(" ");for(;currText.length>0;){const td=tabData[data.tabId];td&&!currText.startsWith(td.data.text)&&(d("[ProcessText] new tab text"),sendCurrentData(data.tabId)),await updateCurrentData(data,currText),firstWord=lastWord-10,lastWord=firstWord+wordMax,currText=words.slice(firstWord,lastWord).join(" ")}}}}).call(this)}).call(this,require("_process"))},{"./remote":7,_process:4,debug:1}],6:[function(require,module,exports){const manifest=chrome.runtime.getManifest();require("debug").enable("*");const d=require("debug")("main"),Alert=require("./alert");chrome.runtime.onMessage.addListener((message,sender,sendResponse)=>{let tabId;switch(d("[in_page] message ->",message),sender.tab&&sender.tab.id&&(tabId=sender.tab.id),message.action){case"eval":Alert.ProcessText({text:message.text,url:sender.url,tabId:sender.tab.id});break;case"eval-docs":if(message.text){const text=JSON.parse(message.text);console.log(text),Array.isArray(text)&&Array.isArray(text[0])&&Alert.ProcessText({text:text[0][0],url:sender.url,tabId})}}}),console.debug(manifest.description,"version",manifest.version,"Loaded.")},{"./alert":5,debug:1}],7:[function(require,module,exports){const d=require("debug")("remote");let wsAlert,wsAlertCheckInt,wsAlertProto="wss";function onAlertOpen(){d("[onOpen] alert agent connection open")}function onAlertError(){wsAlertProto="wss"==wsAlertProto?"ws":"wss"}function wsAlertConnect(){wsAlert&&wsAlert.readyState!==WebSocket.CLOSED&&wsAlert.readyState!==WebSocket.CLOSING||(wsAlert=void 0,wsAlert=new WebSocket(wsAlertProto+"://localhost:6541/websocket"),wsAlert.onopen=onAlertOpen,wsAlert.onerror=onAlertError),wsAlertCheckInt&&clearTimeout(wsAlertCheckInt),wsAlertCheckInt=setTimeout(wsAlertConnect,5e3)}wsAlertConnect(),module.exports.Alert=function(data){data.action="alert",function(data){if(wsAlert&&wsAlert.readyState===WebSocket.OPEN)try{d("[sendAlertMessage] to alert agent -> ",data),wsAlert.send(JSON.stringify(data))}catch(err){console.log(err)}else wsAlertConnect()}(data)}},{debug:1}]},{},[6]);